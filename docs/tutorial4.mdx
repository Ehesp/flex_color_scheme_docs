# Example and tutorial 4 - All Themes

**TODO: Review and update chapter to version 5**

This example shows how you can use all the built-in color schemes, plus three
custom color schemes. How to select which one of these schemes is used to
define the active theme.

The example also uses primary color blending on background and
surface colors. A subpage is available that shows the same theme applied when
opening another page, that in Flutter just inherits the same theme.

> The full code is not shown below, only highlights.
> Please find the complete example code
> [here](https://github.com/rydmike/flex_color_scheme/tree/master/example/lib/example4).

The `main` start function of the app is very similar to example 3.
However, here we use the popular package [Hive](https://pub.dev/packages/hive) to
persist settings and persist the theme settings with a `ThemeServiceHive`
instead of using the `ThemeServicePrefs` service.

## Why do we use Hive here and not SharedPreferences?

The examples are all built using same "example" app. If we use
SharedPreferences in more than one of the apps
they would use the same storage container and share the settings when you
build them locally. By using Hive for most examples, we can change
the storage container name for each example. In these demos the
SharedPreferences service is only used for example 3.

```dart
// The ThemeServiceHive constructor requires a box name, the others do not.
// The box name is just a file name for the file that stores the settings.
final ThemeService themeService = ThemeServiceHive('flex_scheme_box_4');
// Initialize the theme service.
await themeService.init();
// Create a ThemeController that uses the ThemeService.
final ThemeController themeController = ThemeController(themeService);
// Load all the preferred theme settings, while the app is loading, before
// MaterialApp is created. This prevents a sudden theme change when the app
// is first displayed.
await themeController.loadAll();
// Run the app and pass in the ThemeController. The app listens to the
// ThemeController for changes.
runApp(DemoApp(themeController: themeController));
```

Instead of having having our final and const color and scheme definitions
values in the main file, we moved them into a static class called
[AppColor](https://github.com/rydmike/flex_color_scheme/blob/master/example/lib/shared/const/app_color.dart).

There we begin by defining the same colors that we used in example 2 and 3,
to be our first custom color. In this case we also assign a custom color
to the optional `appBarColor`.

```dart
// Create a custom flex scheme color for a light theme.
static const FlexSchemeColor _myScheme1Light = FlexSchemeColor(
  primary: Color(0xFF00296B),
  primaryContainer: Color(0xFF2F5C91),
  secondary: Color(0xFFFF7B00),
  secondaryContainer: Color(0xFFFDB100),
  // The built in schemes use their secondary container color as their
  // custom app bar color, but it can be any color. We use a custom color
  // here. We will see this in example 5 when using the theme and selecting
  // the custom app bar style.
  appBarColor: Color(0xFFf95738),
);
// Create a corresponding custom flex scheme color for a dark theme.
static const FlexSchemeColor _myScheme1Dark = FlexSchemeColor(
  primary: Color(0xFF6B8BC3),
  primaryContainer: Color(0xFF4874AA),
  secondary: Color(0xffff7155),
  secondaryContainer: Color(0xFFF1CB9D),
  appBarColor: Color(0xFF892807),
);
```

You can build a scheme the long way, by specifying all the required
scheme colors, like above, or you can also build schemes from a
single primary color. With the `FlexSchemeColor.from` factory. When doing so
the only required color is the primary color, the other colors will be
computed. You can optionally also provide the `primaryContainer`, `secondary` and
`secondaryContainer` colors with the factory, but any color that is not provided
will always be computed to get all the required colors in `FlexSchemeColor`.

In this example we create our 2nd scheme from just a primary color for the
light and dark schemes. The custom `appBarColor` does in this case also receive
the same color value as the one that is computed for `secondaryContainer`
color. This is its default with the `FlexSchemeColor.from` factory if the
color is not specified.

```dart
 // Vivid green colors.
static final FlexSchemeColor _myScheme2Light =
FlexSchemeColor.from(primary: const Color(0xFF055C34));
static final FlexSchemeColor _myScheme2Dark =
FlexSchemeColor.from(primary: const Color(0xFF629F80));
```

For our 3rd custom color scheme we define primary and secondary colors,
but no container colors, we will not make any dark scheme definitions either, all
these missing colors will be computed. The missing color definitions will
get computed by the factory `FlexSchemeColor.from` when it creates the
`FlexSchemeColor` object. To make our dark colors for this light scheme, we
use the method `toDark` further below with the `_myScheme3Light` instance.


```dart
  // Blue and red colors, for a classic blue and red theme.
 final FlexSchemeColor myScheme3Light = FlexSchemeColor.from(
  primary: const Color(0xFF04368E),
  secondary: const Color(0xFFA00505),
 );
```

Next we create a list `AppData.schemes`, with all the color schemes we will use.
Starting with our three custom color schemes. Normally when we make custom
schemes, those are probably the ones we want to use primarily, so we put them
first in our preferred order. After our custom schemes, we add all the
pre-defined built-in ones, offering them as options users can switch to
and use if they like.

> A **FlexSchemeData** object stores `name` and `description` plus the
> matching `FlexSchemeColor` for `light` and `dark` mode color schemes.

```dart
static final List<FlexSchemeData> schemes = <FlexSchemeData>[
  // We add our custom light and dark FlexSchemeColor schemes we defined
  // to a list of FlexSchemeData, where we can bundle each light and dark
  // theme that goes together and give it a name and description too.
  const FlexSchemeData(
    name: 'C1: Midnight',
    description: 'Midnight blue theme, created by using custom color values '
            'for all colors in the scheme',
    // FlexSchemeData holds separate defined color schemes for light and
    // matching dark theme colors. Dark theme colors typically need to be less
    // saturated versions of their than light counter parts. Using the same
    // colors in light and dark theme modes does not work so well.
    light: _myScheme1Light,
    dark: _myScheme1Dark,
  ),
  // Do the same for our second custom scheme.
  FlexSchemeData(
    name: 'C2: Greens',
    description: 'Vivid green theme, created from one primary color in light '
            'mode and another primary for dark mode',
    light: _myScheme2Light,
    dark: _myScheme2Dark,
  ),
  // We also do the same for our 3rd custom scheme, BUT we create its matching
  // dark colors, from the light FlexSchemeColor with the toDark method.
  FlexSchemeData(
    name: 'C3: Red & Blue',
    description: 'Classic read and blue, created from only light theme mode '
            'primary and secondary colors',
    light: _myScheme3Light,
    // We create the dark desaturated colors from the light scheme.
    dark: _myScheme3Light.toDark(),
  ),
  // Unpack all built-in FlexColor schemes using spread operator into our list.
  ...FlexColor.schemesList,
];
```

The setup of the `MaterialApp` is as simple as in the previous example and
almost identical, for demonstration purposes we use other values for
`surfaceMode` and its `blendLevel`. We also use values for the choice
of `visualDensity` and `fontFamily` from a static `AppData` class.

```dart
class DemoApp extends StatelessWidget {
  const DemoApp({Key? key, required this.themeController}) : super(key: key);
  final ThemeController themeController;

  @override
  Widget build(BuildContext context) {
    // Whenever the user updates theme settings, the MaterialApp is rebuilt.
    return AnimatedBuilder(
      animation: themeController,
      builder: (BuildContext context, Widget? child) {
        return MaterialApp(
          debugShowCheckedModeBanner: false,
          scrollBehavior: AppScrollBehavior(),
          title: 'All Themes',
          // Define the light theme for the app, using current scheme index.
          theme: FlexThemeData.light(
            // We moved the definition of the list of color schemes to use into
            // a separate static class and list. We use the theme controller
            // to change the index of used color scheme from the list.
            colors: AppColor.schemes[themeController.schemeIndex].light,
            // Here we use another surface blend mode, where the scaffold
            // background gets a strong blend. This type is commonly used
            // on web/desktop when you wrap content on the scaffold in a
            // card that has a lighter background.
            surfaceMode: FlexSurfaceMode.highScaffoldLowSurfaces,
            // Our content is not all wrapped in cards in this demo, so
            // we keep the blend level fairly low for good contrast.
            blendLevel: 5,
            appBarElevation: 0.5,
            useSubThemes: themeController.useSubThemes,
            // In this example we use the values for visual density and font
            // from a single static source, so we can change it easily there.
            visualDensity: AppData.visualDensity,
            fontFamily: AppData.font,
          ),
          // We do the exact same definition for the dark theme, but using
          // FlexThemeData.dark() and the dark FlexSchemeColors in our
          // AppColor.schemes list instead.
          darkTheme: FlexThemeData.dark(
            colors: AppColor.schemes[themeController.schemeIndex].dark,
            surfaceMode: FlexSurfaceMode.highScaffoldLowSurfaces,
            // We go with a slightly stronger blend in dark mode. It is worth
            // noticing, that in light mode, the alpha value used for the blends
            // is the blend level value, but in dark mode it is 2x this value.
            // Visually they match fairly well, but it depends on how saturated
            // your dark mode primary color is.
            blendLevel: 7,
            appBarElevation: 0.5,
            useSubThemes: themeController.useSubThemes,
            visualDensity: AppData.visualDensity,
            fontFamily: AppData.font,
          ),
          // Use the dark or light theme based on controller setting.
          themeMode: themeController.themeMode,
          // Here we only pass the theme controller to the HomePage.
          home: HomePage(controller: themeController),
        );
      },
    );
  }
}
 ```

To select which of the 39 themes we use, becomes as simple as
giving the `themeController.schemeIndex` the index value of the color scheme
we want to use. We do that with a simple popup menu button on the `HomePage`.
This is a standard Flutter SDK UI widget, you can find how it is set up
for this use case
[here](https://github.com/rydmike/flex_color_scheme/blob/master/example/lib/example4/widgets/theme_popup_menu.dart).

In the app you can then use the popup menu available in the ListTile, showing the
current theme to change the active theme. You can choose any of the built-in 36
schemes, plus the three custom color schemes we added.

When you change scheme, you will notice that the active theme color changes are
animated by interpolating from the active theme colors, to the new theme colors.
This is a very nice standard feature when you modify the theme used by a Flutter
Material application.

When you build **Example 4**, it starts with the **Blue whale** theme.

[<img src="https://rydmike.com/assets_fcsv4/24-example-4-a-small.jpg?raw=true" alt="ColorScheme example 4 light" />](https://rydmike.com/assets_fcsv4/24-example-4-a.png?raw=true)
[<img src="https://rydmike.com/assets_fcsv4/24-example-4-b-small.jpg?raw=true" alt="ColorScheme example 4 dark" />](https://rydmike.com/assets_fcsv4/24-example-4-b.png?raw=true)
_Example 4) Using custom schemes, plus all the built-in ones as application
theme options (click image to open hires version)_

Scroll down in the app to see the theme showcase further below. It presents the
theme with common Material UI widgets. You can try this example as a Flutter
[web app here](https://rydmike.com/flexcolorschemeV4Tut4).
